<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <link rel="icon" href="Golden-Depths.png" type="image/png">
    <title>Golden Depths</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #1e1e1e;
            color: #f1f1f1;
            overflow: hidden;
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            gap: 1px;
            margin-bottom: 20px;
            position: relative;
        }

        .cell {
            width: 50px;
            height: 50px;
            background-color: #333;
            border: 1px solid #444;
            position: relative;
            transition: background-color 0.3s, box-shadow 0.3s;
        }

        .cell.current-room {
            background-color: #4CAF50;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.6);
        }

        .stench::after {
            content: "S";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: red;
        }

        .breeze::after {
            content: "B";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: #6bbf7c;
        }

        .glitter::after {
            content: "G";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: gold;
        }

        .info {
            margin-bottom: 20px;
            font-size: 18px;
            color: #ddd;
        }

        .controls button {
            padding: 10px 20px;
            margin: 10px;
            background-color: #444;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .controls button:hover {
            background-color: #555;
        }

        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: white;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }

        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }

        @keyframes fadein {
            from { bottom: 0; opacity: 0; }
            to { bottom: 30px; opacity: 1; }
        }

        @keyframes fadeout {
            from { opacity: 1; }
            to { opacity: 0; }
        }

    </style>
</head>
<body>
    <div class="game-container">
        <h1>Wumpus World Game</h1>

        <!-- Show only the current room and partition -->
        <div class="grid" id="grid"></div>

        <div class="info">
            <p id="roomDescription">You are in room (1, 1) looking down.</p>
        </div>

        <div class="controls">
            <button onclick="movePlayer('up')">Up</button>
            <button onclick="movePlayer('down')">Down</button>
            <button onclick="movePlayer('left')">Left</button>
            <button onclick="movePlayer('right')">Right</button>
            <button onclick="shootArrow()">Shoot Arrow</button>
        </div>

        <div id="toast"></div>
    </div>

    <script>
        const gridSize = 8;
        let playerPos = { x: 0, y: 0 }; // Starting position (1,1) in 0-indexed (0,0)
        let wumpusPos, goldPos, pits = [], arrows = 3;
        let direction = 'down'; // Player's current direction
        let gameOverMessage = ''; // Store game over reason
        const restrictedCells = [
            { x: 1, y: 2 },
            { x: 2, y: 1 }
        ];

        // Initialize the game world
        function initializeGame() {
            gameOverMessage = ''; // Reset game over message
            // Randomly place Wumpus, gold, and pits, making sure to avoid restricted cells
            wumpusPos = getRandomPosition();
            goldPos = getRandomPosition();
            pits = [];
            
            while (pits.length < 3) {
                let pit = getRandomPosition();
                if (!isSamePosition(pit, wumpusPos) && !isSamePosition(pit, goldPos)) {
                    pits.push(pit);
                }
            }

            renderGrid();
        }

        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Get random position that isn't in restricted cells
        function getRandomPosition() {
            let pos;
            do {
                pos = { x: randomInt(0, gridSize - 1), y: randomInt(0, gridSize - 1) };
            } while (isRestricted(pos));
            return pos;
        }

        // Check if the position is one of the restricted cells
        function isRestricted(pos) {
            return restrictedCells.some(restricted => restricted.x === pos.x && restricted.y === pos.y);
        }

        function isSamePosition(pos1, pos2) {
            return pos1.x === pos2.x && pos1.y === pos2.y;
        }

        // Render the grid
        function renderGrid() {
            const gridContainer = document.getElementById('grid');
            gridContainer.innerHTML = '';
            for (let y = 0; y < gridSize; y++) {
                for (let x = 0; x < gridSize; x++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');

                    // Show only percepts for the current room
                    if (x === playerPos.x && y === playerPos.y) {
                        // Add sensory clues only for the current room
                        if (isAdjacentToWumpus(x, y)) cell.classList.add('stench');
                        if (isAdjacentToPit(x, y)) cell.classList.add('breeze');
                        if (isAdjacentToGold(x, y)) cell.classList.add('glitter');
                        // Highlight the current room
                        cell.classList.add('current-room');
                    }

                    gridContainer.appendChild(cell);
                }
            }

            // Update room description
            updateRoomDescription();
        }

        // Check for adjacent entities
        function isAdjacentToWumpus(x, y) {
            return (Math.abs(x - wumpusPos.x) === 1 && y === wumpusPos.y) || (Math.abs(y - wumpusPos.y) === 1 && x === wumpusPos.x);
        }

        function isAdjacentToPit(x, y) {
            return pits.some(pit => (Math.abs(x - pit.x) === 1 && y === pit.y) || (Math.abs(y - pit.y) === 1 && x === pit.x));
        }

        function isAdjacentToGold(x, y) {
            return (Math.abs(x - goldPos.x) === 1 && y === goldPos.y) || (Math.abs(y - goldPos.y) === 1 && x === goldPos.x);
        }

        // Update room description with current percepts and direction
        function updateRoomDescription() {
            let percepts = [];
            if (isAdjacentToWumpus(playerPos.x, playerPos.y)) percepts.push('Stench');
            if (isAdjacentToPit(playerPos.x, playerPos.y)) percepts.push('Breeze');
            if (isAdjacentToGold(playerPos.x, playerPos.y)) percepts.push('Glitter');

            const roomDesc = `You are in room (${playerPos.x + 1}, ${playerPos.y + 1}) looking ${direction}. ${percepts.join(', ') || 'No percepts.'}`;
            document.getElementById('roomDescription').textContent = roomDesc;
        }

        // Move the player in the specified direction
        function movePlayer(directionInput) {
            if (gameOverMessage) return; // Prevent moving after game over
            
            switch (directionInput) {
                case 'up':
                    if (playerPos.y > 0) playerPos.y--;
                    direction = 'up';
                    break;
                case 'down':
                    if (playerPos.y < gridSize - 1) playerPos.y++;
                    direction = 'down';
                    break;
                case 'right':
                    if (playerPos.x < gridSize - 1) playerPos.x++;
                    direction = 'right';
                    break;
                case 'left':
                    if (playerPos.x > 0) playerPos.x--;
                    direction = 'left';
                    break;
            }
            updateGameState();
            renderGrid();
        }

        // Show toast message
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = "show";
            setTimeout(function () { toast.className = toast.className.replace("show", ""); }, 3000);
        }

        // Shoot the arrow
        function shootArrow() {
            if (arrows <= 0 || gameOverMessage) return;

            let shootPos = { ...playerPos };

            switch (direction) {
                case 'up':
                    if (shootPos.y > 0) shootPos.y--;
                    break;
                case 'down':
                    if (shootPos.y < gridSize - 1) shootPos.y++;
                    break;
                case 'right':
                    if (shootPos.x < gridSize - 1) shootPos.x++;
                    break;
                case 'left':
                    if (shootPos.x > 0) shootPos.x--;
                    break;
            }

            if (shootPos.x === wumpusPos.x && shootPos.y === wumpusPos.y) {
                showToast("You hit the Wumpus! The stench clears.");
                wumpusPos = null; // Wumpus dies
            } else {
                showToast("The arrow missed.");
            }

            renderGrid();
        }

        // Update game state (win/lose)
        function updateGameState() {
            if (playerPos.x === wumpusPos.x && playerPos.y === wumpusPos.y) {
                gameOverMessage = "The Wumpus ate you!";
                showToast(gameOverMessage);
                resetGame();
            } else if (pits.some(pit => pit.x === playerPos.x && pit.y === playerPos.y)) {
                gameOverMessage = "You fell into a pit!";
                showToast(gameOverMessage);
                resetGame();
            } else if (playerPos.x === goldPos.x && playerPos.y === goldPos.y) {
                gameOverMessage = "You have found the gold! Congratulations, you win!";
                showToast(gameOverMessage);
                resetGame();
            }
        }

        // Reset the game
        function resetGame() {
            setTimeout(() => {
                gameOverMessage = ''; // Reset the game over message
                initializeGame();
                playerPos = { x: 0, y: 0 };
                arrows = 3;
                renderGrid();
            }, 2000); // Wait 2 seconds before restarting
        }

        // Start the game
        initializeGame();
    </script>
</body>
</html>
