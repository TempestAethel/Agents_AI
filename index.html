<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wumpus World Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(8, 50px);
            grid-template-rows: repeat(8, 50px);
            gap: 2px;
            margin-bottom: 20px;
        }
        .cell {
            width: 50px;
            height: 50px;
            border: 1px solid #ccc;
            text-align: center;
            line-height: 50px;
            position: relative;
        }
        .player {
            background-color: green;
            color: white;
        }
        .wumpus {
            background-color: red;
            color: white;
        }
        .pit {
            background-color: brown;
        }
        .gold {
            background-color: yellow;
            color: black;
        }
        .stench::after {
            content: "S";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: red;
        }
        .breeze::after {
            content: "B";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: blue;
        }
        .glitter::after {
            content: "G";
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
            color: gold;
        }
        .info {
            margin-bottom: 20px;
        }
        .controls {
            margin-top: 20px;
        }
        #toast {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #333;
            color: white;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
            font-size: 17px;
        }
        #toast.show {
            visibility: visible;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }
        @keyframes fadein {
            from { bottom: 0; opacity: 0; }
            to { bottom: 30px; opacity: 1; }
        }
        @keyframes fadeout {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Wumpus World Game</h1>

        <div class="grid" id="grid"></div>

        <div class="info">
            <p id="roomDescription">You are in room (1,1). Percepts: </p>
            <p>Moves counter: <span id="movesCounter">0</span></p>
        </div>

        <div class="controls">
            <button onclick="movePlayer('up')">Up</button>
            <button onclick="movePlayer('down')">Down</button>
            <button onclick="movePlayer('right')">Right</button>
            <button onclick="movePlayer('left')">Left</button>
            <button onclick="shootArrow()">Shoot Arrow</button>
        </div>

        <div id="toast"></div>
    </div>

    <script>
        const gridSize = 8;
        let playerPos = { x: 0, y: 0 }; // Starting position (1,1) in 0-indexed (0,0)
        let wumpusPos, goldPos, pits = [], arrows = 3, movesCounter = 0;

        // Initialize the game world
        function initializeGame() {
            // Randomly place Wumpus, gold, and pits
            wumpusPos = { x: randomInt(0, gridSize - 1), y: randomInt(0, gridSize - 1) };
            goldPos = { x: randomInt(0, gridSize - 1), y: randomInt(0, gridSize - 1) };
            
            pits = [];
            while (pits.length < 3) {
                let pit = { x: randomInt(0, gridSize - 1), y: randomInt(0, gridSize - 1) };
                if (!isSamePosition(pit, wumpusPos) && !isSamePosition(pit, goldPos)) {
                    pits.push(pit);
                }
            }

            renderGrid();
        }

        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function isSamePosition(pos1, pos2) {
            return pos1.x === pos2.x && pos1.y === pos2.y;
        }

        // Render the grid
        function renderGrid() {
            const gridContainer = document.getElementById('grid');
            gridContainer.innerHTML = '';
            for (let y = 0; y < gridSize; y++) {
                for (let x = 0; x < gridSize; x++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');

                    // Add sensory clues
                    if (isAdjacentToWumpus(x, y)) cell.classList.add('stench');
                    if (isAdjacentToPit(x, y)) cell.classList.add('breeze');
                    if (isAdjacentToGold(x, y)) cell.classList.add('glitter');

                    // Place the player, wumpus, pits, and gold
                    if (x === playerPos.x && y === playerPos.y) {
                        cell.classList.add('player');
                    } else if (x === wumpusPos.x && y === wumpusPos.y) {
                        cell.classList.add('wumpus');
                    } else if (pits.some(pit => pit.x === x && pit.y === y)) {
                        cell.classList.add('pit');
                    } else if (x === goldPos.x && y === goldPos.y) {
                        cell.classList.add('gold');
                    }

                    gridContainer.appendChild(cell);
                }
            }

            // Update room description
            updateRoomDescription();
        }

        // Check for adjacent entities
        function isAdjacentToWumpus(x, y) {
            return Math.abs(x - wumpusPos.x) <= 1 && Math.abs(y - wumpusPos.y) <= 1;
        }

        function isAdjacentToPit(x, y) {
            return pits.some(pit => Math.abs(x - pit.x) <= 1 && Math.abs(y - pit.y) <= 1);
        }

        function isAdjacentToGold(x, y) {
            return Math.abs(x - goldPos.x) <= 1 && Math.abs(y - goldPos.y) <= 1;
        }

        // Update room description with current percepts
        function updateRoomDescription() {
            const percepts = [];
            if (isAdjacentToWumpus(playerPos.x, playerPos.y)) percepts.push('Stench');
            if (isAdjacentToPit(playerPos.x, playerPos.y)) percepts.push('Breeze');
            if (isAdjacentToGold(playerPos.x, playerPos.y)) percepts.push('Glitter');

            const roomDesc = `You are in room (${playerPos.x + 1}, ${playerPos.y + 1}). Percepts: ${percepts.join(', ') || 'None'}`;
            document.getElementById('roomDescription').textContent = roomDesc;
        }

        // Move the player
        function movePlayer(direction) {
            if (movesCounter >= 10) return;  // Optional: Add a max moves limit

            switch (direction) {
                case 'up':
                    if (playerPos.y > 0) playerPos.y--;
                    break;
                case 'down':
                    if (playerPos.y < gridSize - 1) playerPos.y++;
                    break;
                case 'right':
                    if (playerPos.x < gridSize - 1) playerPos.x++;
                    break;
                case 'left':
                    if (playerPos.x > 0) playerPos.x--;
                    break;
            }

            movesCounter++;
            document.getElementById('movesCounter').textContent = movesCounter;
            updateGameState();
            renderGrid();
        }

        // Shoot the arrow
        function shootArrow() {
            if (arrows <= 0) return;

            // Example: Shoot arrow in a fixed direction, can be expanded with input
            arrows--;
            if (playerPos.x === wumpusPos.x || playerPos.y === wumpusPos.y) {
                alert("You hit the Wumpus!");
                wumpusPos = null; // Wumpus dies
            }
            updateGameState();
        }

        // Update game state
        function updateGameState() {
            if (playerPos.x === wumpusPos.x && playerPos.y === wumpusPos.y) {
                showToast("The Wumpus ate you!");
                resetGame();
            } else if (pits.some(pit => pit.x === playerPos.x && pit.y === playerPos.y)) {
                showToast("You fell into a pit!");
                resetGame();
            } else if (playerPos.x === goldPos.x && playerPos.y === goldPos.y) {
                showToast("You have found the gold! Congratulations, you win!");
                resetGame();
            }
        }

        // Show toast message
        function showToast(message) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = "show";
            setTimeout(function () { toast.className = toast.className.replace("show", ""); }, 3000);
        }

        // Reset the game
        function resetGame() {
            alert("Game over! Resetting the game.");
            initializeGame();
            playerPos = { x: 0, y: 0 };
            movesCounter = 0;
            arrows = 3;
            renderGrid();
        }

        // Start the game
        initializeGame();
    </script>
</body>
</html>
